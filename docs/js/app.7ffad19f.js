(function(t){function e(e){for(var r,i,s=e[0],c=e[1],l=e[2],u=0,h=[];u<s.length;u++)i=s[u],Object.prototype.hasOwnProperty.call(n,i)&&n[i]&&h.push(n[i][0]),n[i]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(t[r]=c[r]);d&&d(e);while(h.length)h.shift()();return o.push.apply(o,l||[]),a()}function a(){for(var t,e=0;e<o.length;e++){for(var a=o[e],r=!0,s=1;s<a.length;s++){var c=a[s];0!==n[c]&&(r=!1)}r&&(o.splice(e--,1),t=i(i.s=a[0]))}return t}var r={},n={app:0},o=[];function i(e){if(r[e])return r[e].exports;var a=r[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.m=t,i.c=r,i.d=function(t,e,a){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(a,r,function(e){return t[e]}.bind(null,r));return a},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/covid19/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=e,s=s.slice();for(var l=0;l<s.length;l++)e(s[l]);var d=c;o.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"56d7":function(t,e,a){"use strict";a.r(e);a("e260"),a("e6cf"),a("cca6"),a("a79d");var r=a("2b0e"),n=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("v-app",[r("v-app-bar",{attrs:{app:"",color:"amber"}},[r("div",{staticClass:"d-flex align-center"},[r("v-img",{staticClass:"shrink mr-2 hidden-md-and-up",attrs:{alt:"Vuetify Logo",contain:"",src:a("cf05"),transition:"scale-transition",height:"5em"}}),r("v-img",{staticClass:"shrink mt-1 hidden-sm-and-down",attrs:{alt:"Vuetify Name",contain:"","min-width":"100",src:a("cf05"),width:"100"}})],1),r("v-toolbar-title",[t._v("COVID-19")]),r("v-spacer")],1),r("v-content",[r("Graphs",{attrs:{strings:t.strings,language:t.language,colors:t.colors}})],1),r("v-footer",{attrs:{absolute:"",app:""}},[r("v-card-text",{staticClass:"text-right"},[t._v(" "+t._s((new Date).getFullYear())+" "),r("a",{attrs:{href:"https://github.com/sdudnic/covid-19",target:"blank"}},[t._v("covid-19")]),t._v(" project by "),r("a",{attrs:{href:"https://github.com/sdudnic",target:"blank"}},[t._v("sdudnic")]),t._v(" & co "),r("v-spacer")],1)],1)],1)},o=[],i=(a("fb6a"),a("d3b7"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("v-row",[a("v-col",[a("v-row",{attrs:{align:"center",justify:"center"}},[a("v-autocomplete",{staticClass:"par-5",staticStyle:{"max-width":"250px"},attrs:{dense:"",label:t.strings.chart.country,items:t.countries,"item-text":"name","item-value":"iso3","hide-details":""},model:{value:t.countryCode,callback:function(e){t.countryCode=e},expression:"countryCode"}}),a("v-text-field",{staticClass:"pal-5",staticStyle:{"max-width":"45px"},attrs:{label:t.strings.chart.daysBack,value:t.daysNumber,dense:"",type:"number","hide-details":""}})],1),a("v-row",{staticClass:"ma-0 pa-0",attrs:{align:"center",justify:"center"}},[a("small",[t._v(" "+t._s(t.strings.lastData)+" "),a("span",{staticClass:"font-weight-bold",attrs:{id:"lastApiUpdate"}},[t._v(t._s(t._f("isoDateTime")(t.history.updateDate)))]),t._v(" (+"+t._s(t.strings.today)+") ")])]),a("v-row",{attrs:{align:"center",justify:"center"}},t._l(t.colors,(function(e,r){return a("v-card",{key:r,staticClass:"ma-5 text-center",style:{opacity:0===t.history.new[r]?.5:1},attrs:{outlined:"",dark:"",color:e}},[a("div",{staticClass:"overline"},[t._v(t._s(t.strings.chart[r]))]),a("div",{staticClass:"pa-1"},[t._v("+ "+t._s(t.history.new[r])+" ("+t._s(t.history.total[r])+")")])])})),1)],1)],1),a("v-row",{staticClass:"text-center"},[a("v-col",{attrs:{cols:"12"}},[a("GChart",{attrs:{type:"LineChart",settings:{packages:["corechart"],language:t.language},data:t.newData,options:t.newChartOptions}})],1),a("v-col",{attrs:{cols:"12"}},[a("GChart",{attrs:{type:"LineChart",settings:{packages:["corechart"],language:t.language},data:t.totalData,options:t.totalChartOptions},on:{ready:t.onChartReady}})],1)],1)],1)}),s=[],c=(a("4de4"),a("7db0"),a("b0c0"),a("4fad"),a("07ac"),a("ac1f"),a("3ca3"),a("5319"),a("ddb0"),a("2b3d"),a("96cf"),a("1da1")),l=a("cb43"),d={name:"Graphs",components:{GChart:l["GChart"]},props:{strings:{type:Object,required:!0},language:{type:String,required:!0},colors:{type:Object,required:!0}},data:function(){return{daysNumber:5,countryCode:"mda",history:{total:{confirmed:0,recovered:0,deaths:0},new:{confirmed:0,recovered:0,deaths:0},updateDate:new Date},totalChartOptions:{title:"Total cases",curveType:"function",legend:{position:"none"},annotations:{stem:{color:"transparent",length:120},textStyle:{color:"red",fontSize:22}},explorer:{},hAxis:{title:"",viewWindowMode:"maximized"},vAxis:{viewWindow:{min:0}},colors:Object.values(this.colors),pointSize:5,pointShape:"diamond"},newChartOptions:{},totalData:{},newData:{},countries:[],apiUrl:{timeline:"https://covidapi.info/api/v1/country/***",current:"https://services1.arcgis.com/0MSEUqKaxRlEPj5g/arcgis/rest/services/Coronavirus_2019_nCoV_Cases/FeatureServer/2/query?where=UPPER(Country_Region)%20like%20%27%25***%25%27&outFields=Last_Update,Confirmed,Deaths,Recovered,Country_Region&returnGeometry=false&outSR=4326&f=json"},startDateString:""}},methods:{getCountries:function(){var t=this;return fetch("./data/countries.json").then((function(t){return t.json()})).then((function(e){return t.countries=e}))},getApiUrl:function(t,e,a){if(!t)return null;var r="***",n="";if(a)n=this.apiUrl.timeline.replace(r,t);else{if(!e)return null;n=this.apiUrl.current.replace(r,e)}return n},filterFromStartDate:function(t){return t[0]>=this.startDateString},updateFields:function(t){this.history.updateDate=t.date,this.history.total.confirmed=t.confirmed,this.history.total.recovered=t.recovered,this.history.total.deaths=t.deaths},onChartReady:function(t,e){var a=this;a.totalData=new e.visualization.DataTable,a.newData=new e.visualization.DataTable,a.totalData.addColumn("date","Date"),a.totalData.addColumn("number",a.strings.chart.confirmed),a.totalData.addColumn("number",a.strings.chart.recovered),a.totalData.addColumn("number",a.strings.chart.deaths),a.totalData.addColumn({role:"annotation",type:"string"}),a.newData.addColumn("date","Date"),a.newData.addColumn("number",a.strings.chart.confirmed),a.newData.addColumn("number",a.strings.chart.recovered),a.newData.addColumn("number",a.strings.chart.deaths),a.newData.addColumn({role:"annotation",type:"string"});var r=new e.visualization.DateFormat({pattern:"dd/MM/yy hh:mm"});r.format(a.totalData,0),r.format(a.newData,0),a.newChartOptions=JSON.parse(JSON.stringify(a.totalChartOptions)),a.loadData(a.countryCode,a.countryName)},cleanTable:function(t){if(t.getNumberOfRows){var e=t.getNumberOfRows();e&&t.removeRows(0,e)}},addNewDataRow:function(t,e,a){var r=this;r.history.updateDate=t.date,r.history.total.confirmed=t.confirmed,r.history.new.confirmed=t.confirmed-e.confirmed,e.confirmed=t.confirmed,r.history.total.recovered=t.recovered,r.history.new.recovered=t.recovered-e.recovered,e.recovered=t.recovered,r.history.total.deaths=t.deaths,r.history.new.deaths=t.deaths-e.deaths,e.deaths=t.deaths,a||(r.totalData.addRow([t.date,t.confirmed,t.recovered,t.deaths,null]),r.newData.addRow([t.date,r.history.new.confirmed,r.history.new.recovered,r.history.new.deaths,null]))},loadData:function(t,e){var a=this;t=t||a.countryCode,e=e||a.countryName;var r=new Date,n=new Date(Date.UTC(r.getUTCFullYear(),r.getUTCMonth(),r.getUTCDate())),o=n.addDays(-a.daysNumber-1);a.startDateString=o.toISOString().slice(0,10),a.totalData.addRow&&(a.totalData.addRow([null,0,0,0,null]),a.newData.addRow([null,0,0,0,null]),a.cleanTable(a.totalData),a.cleanTable(a.newData));var i=a.getApiUrl(t,e,!0),s=a.getApiUrl(t,e,!1),c={date:{},confirmed:0,recovered:0,deaths:0},l={date:{},confirmed:0,recovered:0,deaths:0};fetch(i).then((function(t){return t.json()})).then((function(t){var e=Object.entries(t.result).filter(a.filterFromStartDate);if(0===e.length)a.totalData.addRow([null,0,0,0,"NO DATA"]),a.newData.addRow([null,0,0,0,"NO DATA"]),a.updateFields();else for(var r=0;r<e.length;r++){var n=e[r][1],o=new Date(e[r][0]);l={date:o,confirmed:n.confirmed,recovered:n.recovered,deaths:n.deaths};var i=0==r;a.addNewDataRow(l,c,i)}})).then((function(){fetch(s).then((function(t){return t.json()})).then((function(t){var r=t.features[0].attributes,n=new Date(r.Last_Update);l={date:n,confirmed:r.Confirmed,recovered:r.Recovered,deaths:r.Deaths},a.addNewDataRow(l,c),a.updateFields(l),a.totalChartOptions.title=a.strings.chart.totalTitle+e,a.newChartOptions.title=a.strings.chart.newTitle+e}))})).catch((function(){a.totalData.addRow&&(a.totalData.addRow([null,0,0,0,"NO DATA"]),a.newData.addRow([null,0,0,0,"NO DATA"]),a.updateFields())}))},getIsoCodeFromUrl:function(){var t=this,e=window.location.href,a=new URL(e),r=a.searchParams.get("c")||a.searchParams.get("country");if(!r)return null;r=r.toLowerCase();var n=t.countries.find((function(t){return t.iso3===r}));return n?n.iso3:(n=t.countries.find((function(t){return t.name.toLowerCase()===r})),n?n.iso3:null)},changeTitle:function(t){var e=/(^.*)(COVID-19 evolution graphs,)/,a=t+" $2";document.title=document.title.replace(e,a)},getIso3CodeFromIp:function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(){var e,a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,e={ip:"https://ip.nf/me.json",iso3:"https://raw.githubusercontent.com/sdudnic/covid-19/master/countries/iso3.json"},a={headers:{Origin:"*"}},t.next=5,fetch(e.ip,a).then((function(t){return t.json()})).then((function(t){return fetch(e.iso3).then((function(t){return t.json()})).then((function(e){return e[t.ip.country_code]}))}));case 5:return r=t.sent,t.abrupt("return",r);case 9:return t.prev=9,t.t0=t["catch"](0),t.abrupt("return",null);case 12:case"end":return t.stop()}}),t,null,[[0,9]])})));function e(){return t.apply(this,arguments)}return e}(),countryCodeChanged:function(t){var e=this.countryName;this.loadData(t,e),this.changeTitle(e)}},filters:{isoDateTime:function(t){var e="-";return t&&t instanceof Date&&(e=t.toISOString().slice(0,10)+" "+t.toLocaleTimeString()),e}},computed:{countryName:function(){var t=this.countryCode,e=this.countries;if(!t||!e)return"";var a=e.find((function(e){return e.iso3===t.toLowerCase()}));return a&&a.name?a.name:""}},watch:{countryCode:"countryCodeChanged",daysNumber:"loadData"},beforeMount:function(){Date.prototype.addDays=function(t){var e=new Date(this.valueOf());return e.setDate(e.getDate()+t),e},this.getCountries()},mounted:function(){var t=this;t.totalData&&t.totalData.setColumnLabel&&(t.totalData.setColumnLabel(1,t.strings.chart.confirmed),t.totalData.setColumnLabel(2,t.strings.chart.recovered),t.totalData.setColumnLabel(3,t.strings.chart.deaths),t.newData.setColumnLabel(1,t.strings.chart.confirmed),t.newData.setColumnLabel(2,t.strings.chart.recovered),t.newData.setColumnLabel(3,t.strings.chart.deaths));var e=t.getIsoCodeFromUrl();e?t.countryCode=e:t.getIso3CodeFromIp().then((function(e){e&&(e=e.toLowerCase(),t.countryCode=e)}))}},u=d,h=a("2877"),f=a("6544"),p=a.n(f),v=a("c6a6"),m=a("b0af"),g=a("62ad"),w=a("a523"),y=a("0fd9"),C=a("8654"),D=Object(h["a"])(u,i,s,!1,null,null,null),b=D.exports;p()(D,{VAutocomplete:v["a"],VCard:m["a"],VCol:g["a"],VContainer:w["a"],VRow:y["a"],VTextField:C["a"]});var O={name:"App",components:{Graphs:b},data:function(){return{strings:{chart:{},petition:{}},language:"en",colors:{confirmed:"orange",recovered:"green",deaths:"red"}}},beforeMount:function(){this.getStrings()},methods:{getStrings:function(){var t=this,e=navigator.language||navigator.userLanguage;return t.language=e.slice(0,2),fetch("./data/strings.json").then((function(t){return t.json()})).then((function(e){return t.strings=e[t.language]}))}}},_=O,j=a("7496"),x=a("40dc"),S=a("99d9"),R=a("a75b"),T=a("553a"),N=a("adda"),L=a("2fa4"),V=a("2a7f"),A=Object(h["a"])(_,n,o,!1,null,null,null),U=A.exports;p()(A,{VApp:j["a"],VAppBar:x["a"],VCardText:S["a"],VContent:R["a"],VFooter:T["a"],VImg:N["a"],VSpacer:L["a"],VToolbarTitle:V["a"]});var F=a("f309");r["a"].use(F["a"]);var k=new F["a"]({});r["a"].config.productionTip=!1,new r["a"]({vuetify:k,render:function(t){return t(U)}}).$mount("#app")},cf05:function(t,e,a){t.exports=a.p+"img/logo.35d2f3f9.png"}});
//# sourceMappingURL=app.7ffad19f.js.map